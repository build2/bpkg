// file      : bpkg/fetch -*- C++ -*-
// copyright : Copyright (c) 2014-2016 Code Synthesis Ltd
// license   : MIT; see accompanying LICENSE file

#ifndef BPKG_FETCH
#define BPKG_FETCH

#include <exception>

#include <bpkg/manifest>

#include <bpkg/types>
#include <bpkg/utility>

#include <bpkg/common-options>

namespace bpkg
{
  class checksum_mismatch: public std::exception {};

  repository_manifests fetch_repositories (const dir_path&,
                                           bool ignore_unknown);

  // Verify the checksum and throw checksum_mismatch if it doesn't match.
  //
  repository_manifests fetch_repositories (const common_options&,
                                           const repository_location&,
                                           const string& sha256sum,
                                           bool ignore_unknown);

  package_manifests fetch_packages (const dir_path&,
                                    bool ignore_unknown);
  package_manifests fetch_packages (const common_options&,
                                    const repository_location&,
                                    bool ignore_unknown);

  path
  fetch_archive (const common_options&,
                 const repository_location&,
                 const path& archive,
                 const dir_path& destdir);
}

#endif // BPKG_FETCH
